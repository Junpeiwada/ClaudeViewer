# Claude Code Viewer 実装計画

## 運用ルール

### 1. フェーズベース開発
- 各フェーズは独立した機能単位で構成
- フェーズ完了時に動作確認可能な成果物を提供
- 全フェーズ完了後に統合・最終調整を実施

### 2. 承認プロセス
- 各フェーズ完了時に成果物を提示
- ユーザーが実際にアプリを実行して動作確認
- 承認取得後に次フェーズへ進行
- 修正要望があれば該当フェーズ内で対応

### 3. 成果物の要件
- 動作するElectronアプリケーション
- 該当機能が実際に使用可能
- TypeScript + ESLint構成済み
- 実装内容と確認ポイントをドキュメント化

### 4. 進捗管理
- 各フェーズのタスク状態を明記
- 完了条件と確認事項を定義
- 依存関係と前提条件を整理

---

## フェーズ別実装計画

### Phase 1: プロジェクト基盤構築
**目標**: Electronプロジェクトの初期設定とTypeScript環境構築

#### タスク一覧
- [ ] **基盤-1**: Electronプロジェクト初期化
- [ ] **基盤-2**: TypeScript設定 (tsconfig.json)
- [ ] **基盤-3**: ESLint + Prettier設定
- [ ] **基盤-4**: electron-builder設定
- [ ] **基盤-5**: 基本的なメイン・レンダラープロセス構成

#### 成果物
- 起動可能なElectronアプリ（Hello Worldレベル）
- ビルド・開発環境一式

#### 確認ポイント
- `npm run dev` でアプリが起動する
- TypeScriptのコンパイルが正常に動作
- ESLintでコード品質チェックが機能
- 基本的なウィンドウが表示される

---

### Phase 2: メイン画面レイアウト
**目標**: プロジェクト選択とファイル一覧の基本UI作成

#### タスク一覧
- [ ] **UI-1**: メイン画面レイアウト作成（2ペイン構成）
- [ ] **UI-2**: プロジェクト一覧ペイン（左側）
- [ ] **UI-3**: ファイル一覧ペイン（右側）  
- [ ] **UI-4**: ツールバー（更新・設定ボタン）
- [ ] **UI-5**: ステータスバー
- [ ] **UI-6**: 既存HTMLテーマのCSS統合

#### 成果物
- spec.md/ui.mdに準拠したメイン画面
- レスポンシブなレイアウト

#### 確認ポイント
- 2ペイン構成が正しく表示される
- ウィンドウサイズ変更に対応
- ボタン・UIコンポーネントが配置済み
- 既存HTMLと同等のデザインテーマ

---

### Phase 3: プロジェクト検出・一覧機能
**目標**: ~/.claude/projectsからプロジェクトを検出・表示

#### タスク一覧  
- [ ] **プロジェクト-1**: ファイルシステムアクセス機能
- [ ] **プロジェクト-2**: ~/.claude/projects検出ロジック
- [ ] **プロジェクト-3**: プロジェクト一覧表示
- [ ] **プロジェクト-4**: プロジェクト選択機能
- [ ] **プロジェクト-5**: エラーハンドリング（パスが存在しない場合）

#### 成果物
- プロジェクト自動検出機能付きアプリ
- エラーダイアログ表示機能

#### 確認ポイント
- ~/.claude/projectsが正しく読み取れる
- プロジェクトフォルダが一覧表示される  
- プロジェクト選択でハイライト表示
- パスが存在しない場合のエラー処理

---

### Phase 4: ファイル一覧・管理機能  
**目標**: 選択プロジェクト内のJSONLファイル表示

#### タスク一覧
- [ ] **ファイル-1**: JSONLファイル検出ロジック
- [ ] **ファイル-2**: ファイル情報取得（名前・日時・サイズ）
- [ ] **ファイル-3**: 日付順ソート機能
- [ ] **ファイル-4**: ファイル一覧UI表示
- [ ] **ファイル-5**: ファイル選択機能（シングル・ダブルクリック）

#### 成果物  
- JSONLファイル一覧表示機能
- ファイル選択・情報表示機能

#### 確認ポイント
- プロジェクト選択時にJSONLファイルが表示
- ファイル情報（日時・サイズ）が正確
- 日付順ソートが機能
- ファイル選択でハイライト

---

### Phase 5: claude-conversation-extractor連携
**目標**: 外部ツールによるJSONL→MD変換機能

#### タスク一覧
- [ ] **変換-1**: claude-conversation-extractorバイナリ組み込み
- [ ] **変換-2**: 子プロセス実行ロジック
- [ ] **変換-3**: 変換処理とエラーハンドリング  
- [ ] **変換-4**: 段階ベースプログレス表示
- [ ] **変換-5**: キャンセル機能

#### 成果物
- JSONL→MD変換機能付きアプリ
- プログレス表示・キャンセル機能

#### 確認ポイント  
- JSONLファイルがMDに正常変換される
- プログレス表示が段階的に更新
- キャンセル機能が正常動作
- エラー時の適切な通知

---

### Phase 6: MD→HTML変換機能
**目標**: MDファイルからHTMLコンテンツ生成

#### タスク一覧
- [ ] **HTML-1**: MDパーサー実装（参考実装移植）
- [ ] **HTML-2**: HTML生成ロジック  
- [ ] **HTML-3**: 既存スタイル適用
- [ ] **HTML-4**: キャッシュシステム実装
- [ ] **HTML-5**: キャッシュ無効化（mtime監視）

#### 成果物
- MD→HTML変換機能
- キャッシュ機能付きHTMLジェネレーター

#### 確認ポイント
- MDが既存スタイルでHTML化される
- キャッシュが正しく保存・読み込まれる
- ファイル更新時にキャッシュが無効化
- HTMLの品質（フォーマット・スタイル）

---

### Phase 7: HTMLモーダル表示機能
**目標**: モーダルウィンドウでのHTML表示・ナビゲーション

#### タスク一覧  
- [ ] **モーダル-1**: モーダルウィンドウ基盤実装
- [ ] **モーダル-2**: HTMLコンテンツ表示
- [ ] **モーダル-3**: モーダルツールバー  
- [ ] **モーダル-4**: 前後ファイルナビゲーション
- [ ] **モーダル-5**: モーダル操作（閉じる・キーボード）

#### 成果物
- HTMLモーダル表示機能
- ナビゲーション機能付きビューア

#### 確認ポイント
- ダブルクリックでモーダルが開く
- HTMLが正しく表示される
- ツールバーの各機能が動作
- 前後ファイル移動が可能
- キーボード操作が機能

---

### Phase 8: エクスポート機能
**目標**: HTML/PDF形式でのエクスポート

#### タスク一覧
- [ ] **エクスポート-1**: エクスポートダイアログ
- [ ] **エクスポート-2**: HTML出力機能
- [ ] **エクスポート-3**: PDF変換機能（printToPDF）
- [ ] **エクスポート-4**: ファイル保存処理
- [ ] **エクスポート-5**: エクスポート完了通知

#### 成果物  
- HTML/PDFエクスポート機能
- ファイル保存ダイアログ

#### 確認ポイント
- エクスポートダイアログが表示される
- HTMLファイルが正常出力される
- PDFが適切に生成される
- 保存先選択が機能

---

### Phase 9: 設定・テーマ機能
**目標**: アプリ設定とテーマシステム

#### タスク一覧
- [ ] **設定-1**: 設定ダイアログ作成
- [ ] **設定-2**: Claude Projectsパス設定
- [ ] **設定-3**: システムテーマ連動
- [ ] **設定-4**: キャッシュ管理機能
- [ ] **設定-5**: 設定値永続化

#### 成果物
- 設定機能付きアプリ  
- ダーク・ライトテーマ対応

#### 確認ポイント
- 設定ダイアログが正常動作
- パス設定変更が反映される
- テーマが自動切り替わる
- キャッシュクリア機能

---

### Phase 10: パッケージング・配布準備
**目標**: 本番配布用アプリケーション作成

#### タスク一覧
- [ ] **配布-1**: electron-builder最終設定
- [ ] **配布-2**: macOS .dmgビルド
- [ ] **配布-3**: 自動更新機能（electron-updater）
- [ ] **配布-4**: アプリアイコン・メタデータ
- [ ] **配布-5**: 配布テスト・最終調整

#### 成果物
- インストール可能な.dmgファイル
- 自動更新機能付き配布版アプリ

#### 確認ポイント  
- .dmgファイルが正常作成される
- インストール・起動が問題なし  
- 自動更新チェックが機能
- アプリの安定性確認

---

## 全体スケジュール概要

- **Phase 1-2**: 開発環境・基本UI（基盤）
- **Phase 3-4**: ファイル管理機能（コア）  
- **Phase 5-6**: 変換機能（コア）
- **Phase 7**: モーダル表示（コア）
- **Phase 8-9**: 追加機能（機能拡張）
- **Phase 10**: 配布準備（仕上げ）

各フェーズ完了時に承認を得てから次フェーズに進行します。
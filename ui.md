# UI設計 - Claude Code会話ログビューア

## 画面構成

### 1. メイン画面レイアウト
```
┌─────────────────────────────────────────────┐
│ Claude Code Viewer                    [×][−][□] │
├─────────────────────────────────────────────┤
│ プロジェクト: MyProject ▼    [更新] [設定]     │
├─────────────────────────────────────────────┤
│ ┌─────────────┐ ┌─────────────────────────┐ │
│ │ プロジェクト    │ │ ログファイル一覧           │ │
│ │ 一覧          │ │                       │ │
│ │             │ │ 📄 session_001.jsonl  │ │
│ │ 📁 Project1  │ │   2024-01-15 14:30    │ │
│ │ 📁 Project2  │ │   1.2MB               │ │
│ │ 📁 Project3  │ │                       │ │
│ │             │ │ 📄 session_002.jsonl  │ │
│ │             │ │   2024-01-14 09:15    │ │
│ │             │ │   2.8MB               │ │
│ └─────────────┘ └─────────────────────────┘ │
├─────────────────────────────────────────────┤
│ ステータスバー | Ready                       │ │
└─────────────────────────────────────────────┘
```

### 2. HTMLモーダル表示
```
┌─────────────────────────────────────────────┐
│ Claude Code Viewer          [HTML表示中] [×]  │
├─────────────────────────────────────────────┤
│ ████████████████████████████████████████████ │
│ ██                                      ██ │
│ ██  ┌─────────────────────────────────┐  ██ │
│ ██  │ 📄 session_001.jsonl        [×]  │  ██ │
│ ██  ├─────────────────────────────────┤  ██ │
│ ██  │ [◀] [▶] [⚙] [📤] [🔍]         │  ██ │
│ ██  ├─────────────────────────────────┤  ██ │
│ ██  │                             ↑   │  ██ │
│ ██  │ HTML表示エリア               │   │  ██ │
│ ██  │ (既存スタイル踏襲)           │   │  ██ │
│ ██  │                             ↓   │  ██ │
│ ██  └─────────────────────────────────┘  ██ │
│ ██                                      ██ │
│ ████████████████████████████████████████████ │
└─────────────────────────────────────────────┘
```

### 3. 画面遷移フロー

```
起動
 ↓
プロジェクト検出
 ├─ 成功 → プロジェクト一覧表示
 └─ 失敗 → エラーダイアログ表示
           └─ 設定画面へ誘導

プロジェクト選択
 ↓
jsonlファイル一覧表示
 ↓
ファイル選択（ダブルクリック）
 ├─ キャッシュ有 → HTMLモーダル表示
 └─ キャッシュ無 → 変換処理
                  ├─ 成功 → HTMLモーダル表示  
                  └─ 失敗 → エラー表示

HTMLモーダル表示中
 ├─ [×]ボタン → モーダル閉じる
 ├─ Escキー → モーダル閉じる
 └─ [📤]ボタン → エクスポートダイアログ
```

## 各画面詳細

### 1. メイン画面構成

#### プロジェクト一覧ペイン
- **位置**: 左サイド（幅: 250px）
- **機能**:
  - フォルダ一覧（`~/.claude/projects`）
  - 選択中のプロジェクトをハイライト
  - 右クリックメニュー（フォルダを開く、更新）

#### ファイル一覧ペイン
- **位置**: 右側（幅: メイン領域の70%）
- **表示項目**:
  - ファイル名
  - 更新日時（YYYY-MM-DD HH:mm形式）
  - ファイルサイズ（MB単位）
- **ソート**: 更新日時降順（最新が上）
- **操作**:
  - ダブルクリック → HTMLモーダル表示
  - 右クリックメニュー（ファイルを開く、エクスポート）

### 2. HTMLモーダル画面

#### モーダルウィンドウ
- **サイズ**: 画面の80%（最小: 800x600px）
- **位置**: 中央配置
- **背景**: 半透明オーバーレイ（rgba(0,0,0,0.7)）
- **閉じる方法**: 
  - [×]ボタン
  - Escキー
  - オーバーレイクリック

#### HTMLコンテンツエリア
- **機能**:
  - スクロール可能
  - ズーム機能（Ctrl + マウスホイール）
  - 右クリックメニュー（コピー、エクスポート）
  - 既存HTMLスタイルを完全継承

#### モーダルツールバー
```
[◀] [▶] [⚙] [📤] [🔍]     session_001.jsonl [×]
```
- **[◀][▶]**: 前後のファイルに移動
- **[⚙]**: 表示設定（フォントサイズ、テーマ）
- **[📤]**: エクスポート（HTML/PDF）
- **[🔍]**: コンテンツ内検索（Cmd+F）
- **[×]**: モーダルを閉じる

#### ステータスバー（メイン画面）
- **表示内容**:
  - 処理状況（"Ready", "変換中...", エラーメッセージ）
  - 選択中のプロジェクト名とファイル数
  - 変換中はプログレスバー表示

#### プログレス表示（モーダル内）
```
┌─────────────────────────────────────────┐
│ 変換中... session_001.jsonl            │
├─────────────────────────────────────────┤
│ █████░░░░░░░░░░░░░░░ ⋯  [キャンセル]   │
└─────────────────────────────────────────┘
```
- **表示位置**: モーダル中央にオーバーレイ表示
- **表示条件**: 1MB以上のファイル処理時
- **段階別表示**: 
  - 「準備中...」（ファイル読み込み）
  - 「変換中...」（claude-conversation-extractor実行）
  - 「処理中...」（MD→HTML変換）
  - 「完了」（キャッシュ保存）
- **進捗バー**: 段階ごとに更新、正確な%表示は無し

## ダイアログ設計

### 1. エラーダイアログ
```
┌─────────────────────────────────┐
│ エラー                    [×]    │
├─────────────────────────────────┤
│ ~/.claude/projects フォルダが     │
│ 見つかりません。                 │
│                               │
│ Claude Codeを使用していますか？   │
│                               │
│     [設定を開く]    [OK]        │
└─────────────────────────────────┘
```

### 2. エクスポートダイアログ
```
┌─────────────────────────────────┐
│ エクスポート              [×]    │
├─────────────────────────────────┤
│ ファイル形式:                    │
│ ○ HTML (.html)                 │
│ ○ PDF (.pdf)                   │
│                               │
│ 保存場所: [ドキュメント] [参照]   │
│                               │
│     [キャンセル]    [保存]       │
└─────────────────────────────────┘
```

### 3. 設定ダイアログ
```
┌─────────────────────────────────┐
│ 設定                      [×]    │
├─────────────────────────────────┤
│ Claude Projectsパス:             │
│ [~/.claude/projects    ] [参照]  │
│                               │
│ キャッシュ設定:                  │
│ ☑ HTMLキャッシュを有効           │
│ [キャッシュをクリア]             │
│                               │
│     [キャンセル]    [保存]       │
└─────────────────────────────────┘
```

## インタラクション

### 1. ファイル操作
- **シングルクリック**: ファイル選択（ハイライト表示）
- **ダブルクリック**: 変換開始→HTMLモーダル表示
- **右クリック**: コンテキストメニュー
- **Enter/Space**: 選択中ファイルをモーダル表示

### 2. プログレス表示
- **表示タイミング**: 変換開始から1秒後
- **内容**: 
  - メッセージ: 「準備中...」→「変換中...」→「処理中...」→「完了」
  - プログレスバー: 段階ごとに更新（%表示なし）
  - [キャンセル]ボタン

### 3. キーボードショートカット

#### メイン画面
- `Cmd+R`: 更新
- `Cmd+,`: 設定
- `F5`: プロジェクト一覧更新
- `Enter/Space`: 選択ファイルを開く
- `Escape`: 処理キャンセル

#### HTMLモーダル
- `Escape`: モーダルを閉じる
- `Cmd+F`: コンテンツ内検索
- `Cmd+E`: エクスポート
- `Cmd+W`: モーダルを閉じる
- `←/→`: 前後のファイルに移動
- `Cmd +/-`: ズームイン/アウト

## 応答性・パフォーマンス

### 1. 非同期処理
- ファイル一覧取得: バックグラウンド
- 変換処理: ワーカープロセス
- HTML表示: ストリーミング（段階的表示）

### 2. UI応答性
- 変換中でもメイン画面操作可能
- 他のファイル選択可能（前の処理は自動キャンセル）
- モーダル表示中でもバックグラウンドでファイル一覧更新
- リアルタイムプログレス更新
- モーダル内でのスムーズスクロール

## デザインガイドライン

### 1. カラーテーマ
- **プライマリ**: 既存HTMLテーマに準拠
- **背景**: `#f0f9ff` （薄い青）
- **アクセント**: `#667eea` → `#764ba2` グラデーション

### 2. フォント
- **メイン**: system-ui, -apple-system, sans-serif
- **コード**: 'Courier New', monospace
- **サイズ**: 14px（ベース）

### 3. アイコン
- ファイル: 📄
- フォルダ: 📁  
- エラー: ❌
- 成功: ✅
- 処理中: ⏳